<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sinosoft.etp.cp.analysis.mapper.PeopleAnalysisWithCpMapper">

    <resultMap type="PeopleAndExaminationWithCp" id="AnalysisResult">
        <result property="ksid" column="ksid"/>
        <result property="ksmc" column="ksmc"/>
        <result property="xyid" column="xyid"/>
        <result property="score" column="score"/>
        <result property="kfcd" column="kfcd"/>
        <result property="nickName" column="xyxm"/>
    </resultMap>

    <sql id="selectPeopleAndExamination">
    SELECT
	ex.id as ksid,
	ex.mc as ksmc,
	tes.xyid,
	tes.score,
	su.nick_name xyxm
FROM
	t_examination ex
	LEFT JOIN t_examination_student tes ON ex.id = tes.ksid
	LEFT JOIN sys_user su on tes.xyid = su.user_id
    </sql>

    <select id="selectPeopleAndExaminationResultByKsid" resultMap="AnalysisResult">
        <include refid="selectPeopleAndExamination"/>
        WHERE ex.id  = #{ksid}
        and tes.xyid = #{xyid}

        and ex.del_flag = '0' and tes.del_flag = '0' and su.del_flag = '0'
    </select>

</mapper>

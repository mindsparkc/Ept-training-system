<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sinosoft.admin.question.mapper.QuestionImportRecordMapper">

    <resultMap type="QuestionImportRecord" id="QuestionImportRecordResult">
        <result property="recordId"    column="record_id"    />
        <result property="userId"    column="user_id"    />
        <result property="importDate"    column="import_date"    />
        <result property="total"    column="total"    />
        <result property="fail"    column="fail"    />
        <result property="success"    column="success"    />
        <result property="status"    column="status"    />
        <result property="fileName"    column="file_name"    />
    </resultMap>

    <sql id="selectImportRecordVo">
        select record_id, user_id, import_date, total, fail,
               success, status, file_name
        from question_import_record qu
    </sql>

<!--    // 插入导入记录-->
<!--    public void insertImportRecord(QuestionImportRecord record);-->
    <insert id="insertImportRecord" parameterType="QuestionImportRecord" useGeneratedKeys="true" keyProperty="recordId">
        insert into question_import_record
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="recordId != null">record_id,</if>
            <if test="userId != null">user_id,</if>
            <if test="importDate != null">import_date,</if>
            <if test="total != null and total != ''">total,</if>
            <if test="fail != null and fail != ''">fail,</if>
            <if test="success != null">success,</if>
            <if test="status != null">status,</if>
            <if test="fileName != null">file_name,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="recordId != null">#{recordId},</if>
            <if test="userId != null">#{userId},</if>
            <if test="importDate != null">#{importDate},</if>
            <if test="total != null and total != ''">#{total},</if>
            <if test="fail != null and fail != ''">#{fail},</if>
            <if test="success != null">#{success},</if>
            <if test="status != null">#{status},</if>
            <if test="fileName != null">#{fileName},</if>
        </trim>
    </insert>

<!--    // 查询导入列表-->
<!--    public List<QuestionImportRecord> selectImportRecord(Long userId, String status, String fileName);-->
    <select id="selectImportRecord" resultMap="QuestionImportRecordResult">
        <include refid="selectImportRecordVo"></include>
        <where>
            <if test="userId != null and userId != ''">user_id = #{userId},</if>
            <if test="status != null and status != ''">status = #{status},</if>
            <if test="fileName != null and fileName != ''">file_name = #{fileName},</if>
        </where>
    </select>

<!--    // 提交某 ID 批次的导入，导入提交后，即变成已提交状态，不能再次提交-->
<!--    public void submitImportRecord(Long recordId);-->
    <update id="updateRecordStatus">
        update question_import_record set status = #{status}
        where record_id = #{recordId}
    </update>
</mapper>
